#!/bin/bash
#set -e
set -x  debug

 

####################################################################################

#echo "Checking and creating if it need user data file."
#FILE=~/.decrypt_userdata
#if [ -f $FILE ]; then
#   echo "File '$FILE' exists"
#else
#   echo 'usb="sda1"
#tvip="ENTER_YOUR_TV_IP"' > ~/.decrypt_userdata
#fi
echo "Selecting TV ip address and recording devices."
usb=""
tvip=""
path=""
widgetpath=""
#target="/usr/share/samdecrypt/.decrypt_userdata"
#M_OPTS="$PERM,usb=${USER},tvip=${PASSWD},codepage=cp1250,iocharset=utf8"
[ -e /usr/share/samdecrypt/.decrypt_userdata ] && source /usr/share/samdecrypt/.decrypt_userdata
[ -z $usb ] && exit 1
[ -z $tvip ] && exit 1
[ -z $path ] && exit 1
[ -z $widgetpath ] && exit 1

####################################################################################
#echo "Make widget directory if doesn't exist."
mkdir $widgetpath

widgetfolder="xdg-open $widgetpath"

conf1="/usr/share/samdecrypt/backup-widget.sh"
conf2="/usr/share/samdecrypt/download-decrypt-hub-widgets.sh"
conf3="/usr/share/samdecrypt/reboot-tv"

yad --info \
    --title="Backup widgets" \
    --width=300 \
    --text="Backup widget added manual by <b>user</b>, or installed by <b>Smart hub</b>
    \n<b>Warning:</b> To be able decrypt <b>Smart hub widgets</b> you must have <b>fat32 formatted usb</b> connected to TV, for more info read help!
    \nFor more info visit:
    http://wiki.samygo.tv/index.php5/How_To_Set_Your_Country_Code_In_Smart_Hub" \
    --button="User widgets:$conf1" \
    --button="Smart hub widgets:$conf2" \
    --button="Widget folder:$widgetfolder" \
    --button="Close:1" \
    --kill-parent="1" \

exit



